import{h as w}from"./BLMuvzoS.js";import{b as l,I as C,g as G,s as Q,r as g,j as k,x as U,y as q,c as _,a as t,w as m,F as J,m as T,q as v,k as f,o as p,l as d,z as $,t as u,d as z,O as W,Q as X,J as Z,n as L,H as K,C as tt,_ as et}from"#entry";import{s as st,G as at}from"./Clr2e_nE.js";import{C as nt}from"./DdFW8pdL.js";import{D as lt}from"./CoiHVIeb.js";var ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"};function D(n){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),o.forEach(function(c){rt(n,c,s[c])})}return n}function rt(n,e,s){return e in n?Object.defineProperty(n,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[e]=s,n}var x=function(e,s){var o=D({},e,s.attrs);return l(C,D({},o,{icon:ot}),null)};x.displayName="LineChartOutlined";x.inheritAttrs=!1;var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"};function N(n){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),o.forEach(function(c){it(n,c,s[c])})}return n}function it(n,e,s){return e in n?Object.defineProperty(n,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[e]=s,n}var S=function(e,s){var o=N({},e,s.attrs);return l(C,N({},o,{icon:ct}),null)};S.displayName="RiseOutlined";S.inheritAttrs=!1;var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function M(n){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?Object(arguments[e]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),o.forEach(function(c){ut(n,c,s[c])})}return n}function ut(n,e,s){return e in n?Object.defineProperty(n,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[e]=s,n}var P=function(e,s){var o=M({},e,s.attrs);return l(C,M({},o,{icon:dt}),null)};P.displayName="SyncOutlined";P.inheritAttrs=!1;const _t={class:"fetchers-page fade-in"},pt={class:"control-card enhanced-card slide-in-up"},mt={class:"control-header"},ft={class:"control-info"},vt={class:"control-card enhanced-card slide-in-up",style:{"animation-delay":"0.1s"}},ht={class:"control-header"},bt={class:"stats-card enhanced-card slide-in-up",style:{"animation-delay":"0.2s"}},gt={class:"stats-item"},Ot={class:"stats-value"},yt={class:"stats-item"},wt={class:"stats-value success"},Ct={class:"stats-item"},xt={class:"stats-value disabled"},St={class:"fetchers-grid"},Pt={class:"status-text"},jt={class:"fetcher-header"},kt={class:"fetcher-name"},$t={class:"fetcher-stats"},zt={class:"stat-row"},Lt={class:"stat-item compact"},Dt={class:"stat-number"},Nt={class:"stat-item compact"},Mt={class:"stat-number"},At={class:"stat-row"},Bt={class:"stat-item compact"},Ht={class:"stat-number"},It={class:"stat-item compact"},Vt={class:"stat-number"},Et={class:"fetcher-footer"},Rt={class:"footer-item"},Yt={key:0},Ft={key:1,class:"no-data"},Gt={key:0,class:"footer-time"},Qt={key:0,class:"fetcher-progress"},Ut=G({__name:"fetchers",setup(n){const{$http:e}=Q(),s=g([]),o=g(!0),c=g(""),O=g(!1);let h=null;const A=k(()=>s.value.filter(i=>i.enable).length),B=k(()=>s.value.filter(i=>!i.enable).length),b=async()=>{try{const i=await e.get("/fetchers_status");s.value=i.fetchers.map(a=>({...a,loading:!1})),c.value=w().format("HH:mm:ss")}catch(i){console.error("更新数据失败:",i),v.error("更新数据失败")}},H=async()=>{O.value=!0;try{await e.get("/clear_fetchers_status"),v.success("清空成功"),await b()}catch{v.error("清空失败")}finally{O.value=!1}},I=async i=>{i.loading=!0;try{const a=i.enable?"0":"1";await e.get("/fetcher_enable",{name:i.name,enable:a}),v.success(`${i.name} ${i.enable?"已禁用":"已启用"}`),await b()}catch{v.error("修改失败"),i.loading=!1}};return U(()=>{h=st(()=>{o.value&&b()},2e3),b()}),q(()=>{h&&(clearInterval(h),h=null)}),(i,a)=>{const j=f("a-switch"),y=f("a-col"),V=f("a-button"),E=f("a-tooltip"),R=f("a-row"),Y=f("a-progress");return p(),_("div",_t,[l(R,{gutter:[16,16],class:"control-row"},{default:m(()=>[l(y,{xs:24,sm:12,md:8},{default:m(()=>[t("div",pt,[t("div",mt,[l(d(P),{spin:o.value},null,8,["spin"]),a[1]||(a[1]=t("span",null,"自动刷新",-1))]),l(j,{checked:o.value,"onUpdate:checked":a[0]||(a[0]=r=>o.value=r),size:"large"},null,8,["checked"]),t("div",ft,[l(d($)),t("span",null,u(c.value),1)])])]),_:1}),l(y,{xs:24,sm:12,md:8},{default:m(()=>[t("div",vt,[t("div",ht,[l(d(nt)),a[2]||(a[2]=t("span",null,"数据管理",-1))]),l(V,{type:"primary",danger:"",onClick:H,loading:O.value,size:"large"},{default:m(()=>[l(d(W)),a[3]||(a[3]=z(" 清空统计信息 ",-1))]),_:1},8,["loading"]),l(E,{title:"清空'总共爬取代理数量'等，已经爬取到的代理不会删除"},{default:m(()=>[l(d(X),{class:"help-icon"})]),_:1})])]),_:1}),l(y,{xs:24,sm:24,md:8},{default:m(()=>[t("div",bt,[t("div",gt,[a[4]||(a[4]=t("span",{class:"stats-label"},"爬取器总数",-1)),t("span",Ot,u(s.value.length),1)]),t("div",yt,[a[5]||(a[5]=t("span",{class:"stats-label"},"已启用",-1)),t("span",wt,u(A.value),1)]),t("div",Ct,[a[6]||(a[6]=t("span",{class:"stats-label"},"已禁用",-1)),t("span",xt,u(B.value),1)])])]),_:1})]),_:1}),t("div",St,[(p(!0),_(J,null,T(s.value,(r,F)=>(p(),_("div",{key:r.name,class:"fetcher-card enhanced-card scale-in hover-lift",style:Z({animationDelay:`${F*.05}s`})},[t("div",{class:K(["fetcher-status",{active:r.enable}])},[a[7]||(a[7]=t("span",{class:"status-dot"},null,-1)),t("span",Pt,u(r.enable?"启用中":"已禁用"),1)],2),t("div",jt,[t("h3",kt,[l(d(at)),z(" "+u(r.name),1)]),l(j,{checked:r.enable,onChange:qt=>I(r),loading:r.loading},null,8,["checked","onChange","loading"])]),t("div",$t,[t("div",zt,[t("div",Lt,[l(d(tt),{class:"stat-icon success"}),a[8]||(a[8]=t("span",{class:"stat-label"},"可用",-1)),t("span",Dt,u(r.validated_cnt||0),1)]),t("div",Nt,[l(d(lt),{class:"stat-icon info"}),a[9]||(a[9]=t("span",{class:"stat-label"},"库存",-1)),t("span",Mt,u(r.in_db_cnt||0),1)])]),t("div",At,[t("div",Bt,[l(d(x),{class:"stat-icon primary"}),a[10]||(a[10]=t("span",{class:"stat-label"},"总数",-1)),t("span",Ht,u(r.sum_proxies_cnt||0),1)]),t("div",It,[l(d(S),{class:"stat-icon warning"}),a[11]||(a[11]=t("span",{class:"stat-label"},"本次",-1)),t("span",Vt,u(r.last_proxies_cnt||0),1)])])]),t("div",Et,[t("div",Rt,[l(d($)),r.last_fetch_date?(p(),_("span",Yt,u(d(w)(r.last_fetch_date).fromNow()),1)):(p(),_("span",Ft,"暂无数据"))]),r.last_fetch_date?(p(),_("div",Gt,u(d(w)(r.last_fetch_date).format("YYYY-MM-DD HH:mm")),1)):L("",!0)]),r.sum_proxies_cnt>0?(p(),_("div",Qt,[l(Y,{percent:Math.min(100,r.validated_cnt/r.sum_proxies_cnt*100),"show-info":!1,"stroke-color":{"0%":"#108ee9","100%":"#87d068"},size:"small"},null,8,["percent"])])):L("",!0)],4))),128))])])}}}),Kt=et(Ut,[["__scopeId","data-v-388abd13"]]);export{Kt as default};
